<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<meta name="renderer" content="webkit">
  		<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
		<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
		<title>An Online B2B market——-Shoestp.com,gathering 300 professional shoes manufacture companies Business backstage</title>
		<script src="../../static/admin/js/jquery-1.11.1.js" type="text/javascript" charset="utf-8"></script>
		<script src="../../static/admin/layui/layui.js" type="text/javascript" charset="utf-8"></script>
		<link rel="stylesheet" type="text/css" href="../../static/admin/layui/css/layui.css"/>
		<link rel="stylesheet" type="text/css" href="../../static/admin/css/admin.css"/>
		<style>
			/*更改密码的外框 */
			#pwdForm{
				width: 50%;
				min-width: 600px;
				padding-right: 15px;
				box-sizing: border-box;
			}
			/* logo 图  */
			.layui-upload-img {
 				max-width: 100%;
				height: 200px;
				object-fit: contain;
			}
			
		</style>
	</head>
<body>
<fieldset class="layui-elem-field layui-field-title" style="margin-top: 20px;">
  <legend>账户设置</legend>
</fieldset>
<blockquote class="layui-elem-quote" style="color: #666;">
请保管好您的账号和密码!
</blockquote>   
  <table class="layui-table min-width1200">
    <colgroup>
      <col width="150">
      <col width="150">
      <col width="200">
      <col>
    </colgroup>
    <tbody>
      <tr>
      <td style="width:50%">
      <form action="">
 <div class="layui-form-item">
    <label class="layui-form-label">用户名:</label>
    <div class="layui-input-block">
      <input name="bean.loginName" style="border:0;" id="loginName"  readonly="readonly"  lay-verify="title" autocomplete="off" placeholder="" class="layui-input" type="text">
    </div>
  </div>
 <div class="layui-form-item">
    <label class="layui-form-label">账户状态:</label>
    <div class="layui-input-block">
      <input name="bean.isAuth" style="border:0;" id="isAuth" readonly="readonly"  autocomplete="off"   class="layui-input" type="text">
    </div>
  </div>
   <div class="layui-form-item">
    <label class="layui-form-label">店铺名称:</label>
    <div class="layui-input-block">
      <input name="bean.Name" style="border:0;" id="name"     readonly="readonly"    autocomplete="off"   class="layui-input" type="text">
    </div>
  </div>
  <div class="layui-form-item">
    <label class="layui-form-label">企业类型:</label>
    <div class="layui-input-block">
      <input name="bean.companyType" style="border:0;" readonly="readonly"     id="companyType" autocomplete="off"   class="layui-input" type="text">
    </div>
  </div>
   <div class="layui-form-item">
    <label class="layui-form-label">最后登录:</label>
    <div class="layui-input-block">
      <input name="title" id="loginDate" style="border:0;" lay-verify="title"  readonly="readonly" autocomplete="off"   class="layui-input" type="text">
    </div>
  </div>
      </form>
      </td>
 <td>
<div class="layui-upload-drag" id="logo" style="text-align: center;">
  <p>点击更换LOGO</p>
</div>
      </td>
   </tr> 
  <tr>
   
 </tr>
    </tbody>
  </table>  
  <fieldset class="layui-elem-field layui-field-title" style="margin-top: 20px;">
  <legend>密码设置</legend>
</fieldset>

<!--   <table class="layui-table"> -->
<!--     <colgroup> -->
<!--       <col width="150"> -->
<!--       <col width="150"> -->
<!--       <col width="200"> -->
<!--       <col> -->
<!--     </colgroup> -->
<!--     <tbody> -->
<!--       <tr> -->
<!--   <td style="border-right: 0px"> -->
<!--       <form action=""  id="pwdForm"> -->
<!--  <div class="layui-form-item"> -->
<!--     <label class="layui-form-label">原密码:</label> -->
<!--     <div class="layui-input-block"> -->
<!--       <input name="mmOld" id="mmOld"    autocomplete="off" placeholder="" class="layui-input" type="password"> -->
<!--     </div> -->
<!--   </div> -->
<!--  <div class="layui-form-item"> -->
<!--     <label class="layui-form-label">新密码:</label> -->
<!--     <div class="layui-input-block"> -->
<!--       <input name="mmNew" id="pwd" autocomplete="off"   class="layui-input" type="password"> -->
<!--     </div> -->
<!--   </div> -->
<!--    <div class="layui-form-item"> -->
<!--     <label class="layui-form-label">确认密码:</label> -->
<!--     <div class="layui-input-block"> -->
<!--       <input name="checkpwd" id="checkpwd" autocomplete="off"   class="layui-input" type="password"> -->
<!--       <input type="text" name="bean.rowVersion" id="rowVersionMm"  style="display: none" autocomplete="off" class="layui-input"> -->
<!--     </div> -->
<!--   </div> -->
<!--       </form> -->
<!-- 	<label class="layui-form-label">  </label> -->
<!-- 	<button class="layui-btn layui-btn-lg layui-btn-normal"  onclick="updPwd()">提交</button> -->
<!--    	<button class="layui-btn layui-btn-primary" onclick="">取消</button>     -->
<!--       </td> -->
<!--  <td> -->

<!--  </td> -->
<!--    </tr>  -->
<!--    </tbody> -->
<!--   </table>   -->

<form action="" class="layui-form"  id="pwdForm" style="width: 50%">
 <div class="layui-form-item">
    <label class="layui-form-label">原密码:</label>
    <div class="layui-input-block">
      <input name="oldPwd" id="mmOld"    autocomplete="off" placeholder="" class="layui-input" type="password">
    </div>
  </div>
 <div class="layui-form-item">
    <label class="layui-form-label">新密码:</label>
    <div class="layui-input-block">
      <input name="newPwd" id="pwd" autocomplete="off" maxlength="15" class="layui-input" type="password"><!-- onblur="verifyInput(this)" --> 
    </div>
  </div>
  <div class="layui-form-item">
    <label class="layui-form-label">确认密码:</label>
    <div class="layui-input-block">
      <input name="checkpwd" id="checkpwd" autocomplete="off" maxlength="15"   class="layui-input" type="password"><!-- onblur="verifyConfirm(this)" -->
      <p style="font-size: 14px;color: red;font-family: fantasy;display:none;" >密码输入不一致</p>
      <input type="hidden" name="bean.rowVersion" id="rowVersionMm" >
    </div>
  </div>
  <div class="layui-form-item"> 
	  <label class="layui-form-label">  </label>
	  <div class="layui-block">
		<button class="layui-btn layui-btn-lg" type="button" onclick="updPwd()">提交</button>
	   	<button class="layui-btn layui-btn-primary" onclick="">取消</button>    
	 </div>
  </div>
</form>
	
   	
   	
 <input name="" id="datapwd" autocomplete="off"  style="display: none"  class="layui-input" type="text">
 <form id="updlogo" style="display: none;">
 <input name="logo" id="logoForm" autocomplete="off"   class="layui-input" type="text">
 <input type="text" name="bean.rowVersion" id="rowVersion"  autocomplete="off" class="layui-input">
 </form>
<script>
layui.use(['upload','layer'], function(){
	  var $ = layui.jquery
	  ,upload = layui.upload
	  ,layer = layui.layer;	
	  upload.render({
		    elem: '#logo'
		    ,url: '/seller/usr_UsrSupplier_upload'
		    ,done: function(response){
		    	if(response.ret == 1) {
			    	var logo = response.result.url;
					$("#logoForm").val(logo);
					$.ajax({
			 			type:'post',
			 			url:'/seller/usr_UsrSupplier_updLogo',
			 			dataType:'json',
			 			data:$("#updlogo").serialize(),
			 			success:function(response){
			 				if(response.ret == 1) {
			 					$("#logo").empty();
			 					$("#logo").append('<p>点击更换LOGO</p><img src="'+parent.imgUrlconfig + logo +'" alt="" class="layui-upload-img" >');
			 				}
			 			}
			 		})	 
		    	} else {
					layer.msg("更换LOGO失败",{time:3000});
		    	}
		    }
		  });
	});
	function getDate(){
		var myDate = new Date();
		//获取当前年
		var year=myDate.getFullYear();
		//获取当前月
		var month=myDate.getMonth()+1;
		//获取当前日
		var date=myDate.getDate(); 
		var h=myDate.getHours();       //获取当前小时数(0-23)
		var m=myDate.getMinutes();     //获取当前分钟数(0-59)
		var s=myDate.getSeconds();  	
		var now=year+'-'+month+"-"+date+" "+h+':'+m+":"+s;
		return now;
		
	}
window.onload=function(){
	  $.ajax({
			type:'post',
			url:'/seller/usr_UsrSupplier_selSupplier',
			dataType:'json',
			success:function(data){
				if(data.ret == 1) {
					$("#loginName").val(data.result.loginName == ''?'无':data.result.loginName);
					$("#isAuth").val(data.result.status==0?'未审核':'已审核');
					$("#name").val(data.result.name == ''?'无':data.result.name);
					$("#companyType").val(data.result.companyType == ''?'无':data.result.companyType);
					$("#loginDate").val(getDate() == ''?'无':getDate());
					$('#logo').append('<img src="'+parent.imgUrlconfig + data.result.logo +'" alt="" class="layui-upload-img" >')
				}
			}
		})
}

function verifyInput(btn){
	var input = $(btn).val();
	//^(?=.*\d)(?=.*[a-zA-Z])(?=.*[~!@#$%^&*])[\da-zA-Z~!@#$%^&*]{8,}$
	var reg = /^[0-9a-zA-Z~!@#$%^&*]{6,}$/;
	if(!reg.test(input)){
		layer.msg("请输入6~15位的数字/字母/部分特殊字符",{icon:2,time:2000});
	}
	
}

function verifyConfirm(btn){
	var newPWD = $("#pwdForm input[name=newPwd]").val();
	var confirm = $(btn).val();
	if(newPWD != confirm){
		$(btn).next().show();
	}else{
		$(btn).next().hide();
	}
}
function  updPwd(){
	if($("#pwd").val().length<8||$("#pwd").val().length>16){
		layer.msg("请输入8~15位的数字/字母/部分特殊字符",{icon:2,time:2000}); 
		return;
	}
	if($("#pwd").val()!=$("#checkpwd").val()){
	layer.msg("两次密码不一致!",{icon:2,time:2000}); 
	return;
	}
	if(!isNaN($("#pwd").val())){
		layer.msg("请输入8~15位的数字/字母/部分特殊字符",{icon:2,time:2000}); 
		return;
	}
	 if($("#checkpwd").val()==$("#pwd").val() && $("#checkpwd").val()!=null && $("#pwd").val()!=null && $("#pwd").val().trim()!=""){
	  $.ajax({
			type:'post',
			url:'/seller/usr_UsrSupplier_UpdPwd',
			dataType:'json',
			data:$("#pwdForm").serialize(),
			success:function(data){
			    if (data.ret==1) {
					layer.msg("修改成功！", {
					  icon: 1,
					  time: 2000 
					}) 
					var version='';
					$.each(data,function(i,item){
						version=data["bean.rowVersion"];
					});
					$("#rowVersion").val(version);	
					$("#rowVersionMm").val(version);
					setTimeout(function(){					
						location.reload();
					},1500)
				}else if(data.ret==0){
					layer.open({
					  content: data.msg
					});
				}
			}
		})
	 }else{ 
		layer.open({
		  content: '请填写正确的密码信息'
		});
	 }
}

</script>
	</body>
</html>